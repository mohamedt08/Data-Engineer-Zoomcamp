-- Question 3. For the trips in November 2025,how many trips had a trip_distance of less than or equal to 1 mile?
select count(*) 
from public.green_taxi_data
where trip_distance <= 1 and date(lpep_pickup_datetime) between '2025-11-01' and '2025-11-30'

--Question 4. Which was the pick up day with the longest trip distance? Only consider trips with trip_distance less than 100 miles.

select date(lpep_pickup_datetime) 
from public.green_taxi_data
where trip_distance < 100 
order by trip_distance DESC
LIMIT 1


--Question 5. Which was the pickup zone with the 
--largest total_amount (sum of all trips) on November 18th, 2025?

SELECT tzd."Zone"
from public.green_taxi_data as gtd
JOIN public.taxi_zones_data as tzd on gtd."PULocationID" = tzd."LocationID"
WHERE date(lpep_pickup_datetime) = '2025-11-18'
group by 1
ORDER by sum(total_amount) DESC
LIMIT 1


--Question 6.For the passengers picked up in the zone named "East Harlem North" in November 2025, 
--which was the drop off zone that had the largest tip?

SELECT dod."Zone"
from public.green_taxi_data as gtd
JOIN public.taxi_zones_data as tzd on gtd."PULocationID" = tzd."LocationID"
JOIN public.taxi_zones_data as dod on gtd."DOLocationID" = dod."LocationID"
WHERE date(lpep_pickup_datetime) between'2025-11-01' and '2025-11-30'
and tzd."Zone" = 'East Harlem North'
order by tip_amount DESC
limit 1

